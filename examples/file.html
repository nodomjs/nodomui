<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>nodomui example - panel usage</title>
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <script src='js/nodom.js'></script>
    <script src='../dist/msg_zh.js'></script>
    <script src='../dist/uibase.js'></script>
    <script src='../dist/file.js'></script>
</head>
<body>
    <div>
        <p>单文件</p>
        <!-- deleteUrl='http://localhost:3000/delres' -->
        <ui-file x-field='files' valueField='id' displayField="url" uploadName='file' 
            uploadUrl='http://localhost:3000/upload'></ui-file>

        <p>多文件</p>
        <ui-file x-field='photos' multiple valueField='id' displayField="url"  uploadName='file'
        uploadUrl='http://localhost:3000/upload' fileType='image'
        maxCount='5'></ui-file>
    </div>

</body>
<script>
    nodom.newApp({
        module:{
            el:'div',
            data:{
                files:[],
                photos:[]
            },
            /*uploadFile:function(dom,model,module,e){
                let xhr = new XMLHttpRequest();
                xhr.open('POST','http://localhost:3000/upload');
                let form = new FormData();
                let files = model.data['$file_photos'];
                for(let f of files){
                    form.append('photo',f);
                }
                xhr.setRequestHeader('Content-Type','multipart/form-data');
                xhr.send(form);
                xhr.onload = (x)=>{
                    let r = JSON.parse(xhr.responseText);
                    for(let r1 of r.rows){
                        model.data['photos'].push({
                            imgId:r1.id,
                            imgUrl:r1.url,
                            fileName:r1.fileName
                        });
                    }
                    model.set('$uploadstate_photos',0);
                }
            },
            delFile:function(dom,model,module,e){
                let rows = module.model.data['photos'];
                for(let i=0;i<rows.length;i++){
                    if(rows[i].imgId === model.data['imgId']){
                        rows.splice(i,1);
                        break;
                    }
                }
            }*/
        }
    });
</script>
</html>